---
title: "Untitled"
output: html_document
---

```{r}
library(knitr)
library(tidyverse)
library(kableExtra)
```

```{r}
qbs <- readRDS("qbc.RDS")
colorFun <- function(x){
  ifelse(grepl("Yes", x), "green",
         ifelse(grepl("No", x), "red",
                ifelse(grepl("Other", x), "grey", "white")))
}

qbs <- qbs %>%
  mutate_at(vars(-Category),function(x){
    cell_spec(x, background = colorFun(as.character(x)))
  })

```




```{r}
catSum <- cumsum(table(qbs$Category))
```

```{r}

x <-  kable(qbs, escape = F, align = "c")%>%
  kable_styling(c("striped", "condensed"), full_width = F, fixed_thead = TRUE) %>%
  pack_rows(names(catSum)[1], 1, catSum[1])

for(i in 2:length(catSum)){
  x <-  x %>%
    pack_rows(names(catSum)[i], catSum[i-1] + 1, catSum[i])
}

x



```


